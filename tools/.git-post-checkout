#!/bin/zsh
####
# Try and restore permissions
####

TOPDIR="$(git rev-parse --show-toplevel)"
PERMDB="${TOPDIR}/.permissions"

echo -n "Restoring file permissions..."
case "${OSTYPE}" in
  darwin*)
    if [ -e "${PERMDB}" ]; then
      source "${TOPDIR}/.permissions"
      pushd "${TOPDIR}"
      for file in ${(@k)PERM}; do
        eval chmod ${PERM[${file}]} "${file}"
      done
      popd
      echo "OK"
    fi
  ;;
  *) echo "UNSUPPORTED" ;;
esac

# vim: tabstop=2 expandtab shiftwidth=2 softtabstop=2
